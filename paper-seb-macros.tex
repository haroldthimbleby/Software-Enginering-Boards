% These macros allow the paper and the supplementary material to share a single sequence of bibliography citations

\DeclareUrlCommand\doi{\def\UrlLeft{{\textrm{DOI}}~}}
\DeclareUrlCommand\url{\def\UrlLeft{{\textrm{URL}}~}}
	
\renewcommand{\thefootnote}{\fnsymbol{footnote}}

\def\mytitle{Computational science reviewed: \hbox{A (fixable) failure of software~engineering}}
%Achieving professional software engineering \hbox{in scientific research}}

\def \citeeg#1{(e.g., \cite{#1})}

\def\inputifexists#1#2{\IfFileExists{#1}{\input{#1}}{\typeout{No file #1. #2}}}

% calculate percentages
\newcount \t
\newcount \tu
\def\pc#1#2{\t = #1%
\multiply \t by 100000%
\divide \t by #2% ?? 0 times percentage
\tu = \t
\divide \t by 1000% percentage, but no idea of remainder
\multiply \t by 1000% 1000 times percentage, with 00 as bottom digits
\advance \tu by -\t% bottom two digits
\divide \t by 1000\relax%
% round to nearest integer
% if ending in > .5 round up
% if ending in exactly .5 round towards nearest even number
\ifnum \tu > 500 % round up
	\advance \t by 1 
\else
	\ifnum \tu = 500 
		\ifodd \t % it's odd, so round up to even number 
			\advance \t by 1
		\else % leave rounded to even number 	
		\fi
	\fi
\fi
\the\t\%}

% insert commas into large numbers
\def\commarise#1{%[#1]
	\t=#1
    \divide \t by 1000
    \ifnum \t > 0
    	\the\t,%
    	\tu=#1
    	\multiply \t by 1000
    	\advance \tu by -\t
		\ifnum \tu < 100 0\fi
		\ifnum \tu < 10 0\fi
		\the\tu
    \else
    	#1%
    \fi
}

% simple macro to use a number register to pluralise (add an s) to words....
% \plural{\t}{fred} => \the\t\ freds if plural, or => one fred if singular
\def\plural#1#2{\ifnum #1=1 
	one #2%
\else
	\the#1\ #2s%
\fi}

% initialisBibliography <title> <starting number> <introductory text>
\newcount\bibciten \bibciten=0
\def\initialiseBibliography#1#2#3{%
	\global\def\refname{#1}
    \global\bibciten=#2
    \global\def\startBibliography{#3}
}

\def\bibskip{\vskip 1ex} % the gap between bib items generated by data.js

% read in any constants defined from the JSON data
\input generated-constants.tex
\IfFileExists{generated-info-for-main.tex}{%
\input generated-info-for-main.tex
}{\typeout{No generated-info-for-main.tex - error ignored, but you need to latex paper-seb-supplementary-material.tex to generate it}}

%\inputifexists{generated-constants.tex}{You need to run node data.js to make this file}

\def\supplement{Supplemental Material}

